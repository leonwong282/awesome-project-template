# ðŸš€ Automated Release
# Uses Release Please to automate releases based on conventional commits
# Learn more: https://github.com/google-github-actions/release-please-action

name: Release

on:
  push:
    branches: [main]
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write

jobs:
  release-please:
    name: Release Please
    runs-on: ubuntu-latest

    outputs:
      release_created: ${{ steps.release.outputs.release_created }}
      tag_name: ${{ steps.release.outputs.tag_name }}
      version: ${{ steps.release.outputs.version }}

    steps:
      - name: Run Release Please
        id: release
        uses: google-github-actions/release-please-action@v4
        with:
          # Release type - use 'simple' for basic projects
          # Options: node, python, go, simple, etc.
          release-type: simple

          # Token for creating releases and PRs
          token: ${{ secrets.GITHUB_TOKEN }}

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # OPTIONAL: Post-release actions
  # Uncomment and customize based on your needs
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  # publish-npm:
  #   name: Publish to npm
  #   runs-on: ubuntu-latest
  #   needs: release-please
  #   if: ${{ needs.release-please.outputs.release_created }}
  #   steps:
  #     - uses: actions/checkout@v4
  #     - uses: actions/setup-node@v4
  #       with:
  #         node-version: '20'
  #         registry-url: 'https://registry.npmjs.org'
  #     - run: npm ci
  #     - run: npm publish
  #       env:
  #         NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}

  # publish-pypi:
  #   name: Publish to PyPI
  #   runs-on: ubuntu-latest
  #   needs: release-please
  #   if: ${{ needs.release-please.outputs.release_created }}
  #   steps:
  #     - uses: actions/checkout@v4
  #     - uses: actions/setup-python@v5
  #       with:
  #         python-version: '3.12'
  #     - run: pip install build twine
  #     - run: python -m build
  #     - run: twine upload dist/*
  #       env:
  #         TWINE_USERNAME: __token__
  #         TWINE_PASSWORD: ${{ secrets.PYPI_TOKEN }}

  # publish-docker:
  #   name: Publish Docker Image
  #   runs-on: ubuntu-latest
  #   needs: release-please
  #   if: ${{ needs.release-please.outputs.release_created }}
  #   steps:
  #     - uses: actions/checkout@v4
  #     - name: Login to GitHub Container Registry
  #       uses: docker/login-action@v3
  #       with:
  #         registry: ghcr.io
  #         username: ${{ github.actor }}
  #         password: ${{ secrets.GITHUB_TOKEN }}
  #     - name: Build and push
  #       uses: docker/build-push-action@v5
  #       with:
  #         push: true
  #         tags: |
  #           ghcr.io/${{ github.repository }}:${{ needs.release-please.outputs.version }}
  #           ghcr.io/${{ github.repository }}:latest

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# HOW IT WORKS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#
# 1. CONVENTIONAL COMMITS: Use these prefixes in your commit messages:
#    - feat: New feature (bumps MINOR version)
#    - fix: Bug fix (bumps PATCH version)
#    - feat!: or BREAKING CHANGE: (bumps MAJOR version)
#    - docs:, style:, refactor:, test:, chore: (no version bump)
#
# 2. RELEASE PR: When you push to main with releasable commits,
#    Release Please creates/updates a PR with:
#    - Updated CHANGELOG.md
#    - Version bump in relevant files
#
# 3. RELEASE: Merge the Release PR to:
#    - Create a GitHub Release with release notes
#    - Tag the commit with the version
#    - Trigger any post-release jobs (publishing, etc.)
#
# 4. RELEASE TYPES:
#    - simple: Basic versioning (VERSION file or package.json)
#    - node: Node.js projects (package.json)
#    - python: Python projects (setup.py, pyproject.toml)
#    - go: Go projects (version.go)
#    - rust: Rust projects (Cargo.toml)
#
# 5. CONFIGURATION: Create .release-please-manifest.json and
#    release-please-config.json for advanced configuration.
#    See: https://github.com/googleapis/release-please/blob/main/docs/manifest-releaser.md
